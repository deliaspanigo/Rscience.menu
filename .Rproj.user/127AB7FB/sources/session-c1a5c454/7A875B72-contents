library(yaml)


cargar_todos_yaml <- function(dir_path) {
  archivos <- list.files(dir_path, pattern = "\\.yaml$", full.names = TRUE)
  lista <- list()
  for (arch in archivos) {
    nombre <- basename(arch)
    lista[[nombre]] <- yaml.load_file(arch)$choices
  }
  return(lista)
}

yaml_2_R <- function(choices){
  
# Extraer los vectores
vector_choice_external <- sapply(choices, function(x) x$choice_external)
vector_choice_internal <- sapply(choices, function(x) x$choice_internal)
vector_files <- sapply(choices, function(x) x$file)
vector_file_names <- tools::file_path_sans_ext(vector_files)

# Crear una lista con los vectores
resultado <- list(
  choice_external = vector_choice_external,
  choice_internal = vector_choice_internal,
  vector_files = vector_files,
  vector_file_names = vector_file_names
)

return(resultado)

}

dir_path <- file.path("inst", "yaml")
list.files(dir_path, pattern = "\\.yaml$", full.names = TRUE)

list_yaml <- cargar_todos_yaml(dir_path)

list_R    <- lapply(list_yaml, yaml_2_R)
list_R    <- lapply(list_R, function(x){
  mi_list <- x
  vector_files <- x$vector_files
  vector_file_names <- x$vector_file_names
  
  vector_files[vector_files == ""] <- NA
  vector_file_names[vector_file_names == ""] <- NA
  
  mi_list$vector_files <- vector_files
  mi_list$vector_file_names <- vector_file_names
  mi_list
})
list_df_R <- lapply(list_R, data.frame)
names(list_df_R) <- tools::file_path_sans_ext(names(list_df_R))
  
list_df_R