
cargar_todos_yaml <- function(dir_path) {
  archivos <- list.files(dir_path, pattern = "\\.yaml$", full.names = TRUE)
  lista <- list()
  for (arch in archivos) {
    nombre <- basename(arch)
    lista[[nombre]] <- yaml.load_file(arch)$choices
  }
  return(lista)
}

dir_path <- file.path("inst", "yaml")
#dir_path <- file.path(folder_base, the_file)
mis_opt <- cargar_todos_yaml(dir_path) 

mis_opt

lapply(mis_opt, function(x){
  
  sapply(x, function(y){
    # y <- x[[1]]
    my_external <- y$choice_external
    my_internal <- y$choice_internal
    
    my_opt <- my_internal
    names(my_opt) <- my_external
    my_opt
    # my_new_file <- y$file
    # c(my_external, my_internal, my_new_file)
        #names(mi_opt) <- y$choice_external
  })    
  
})
